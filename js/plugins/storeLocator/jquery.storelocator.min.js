/*! jQuery Google Maps Store Locator - v3.0.1 - 2018-09-29
* http://www.bjornblog.com/web/jquery-store-locator-plugin
* Copyright (c) 2018 Bjorn Holine; Licensed MIT */

!function(a,b,c,d){"use strict";function e(b,c){g=a(b),this.element=b,this.settings=a.extend({},H,c),this._defaults=H,this._name=f,this.init()}var f="storeLocator";if("undefined"==typeof a.fn[f]&&"undefined"!=typeof google){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=[],A=[],B=[],C=[],D={},E={},F={},G={},H={ajaxData:null,altDistanceNoResult:!1,autoComplete:!1,autoCompleteDisableListener:!1,autoCompleteOptions:{},autoGeocode:!1,bounceMarker:!0,catMarkers:null,dataLocation:"data/locations.json",dataRaw:null,dataType:"json",debug:!1,defaultLat:null,defaultLng:null,defaultLoc:!1,disableAlphaMarkers:!1,distanceAlert:60,dragSearch:!1,exclusiveFiltering:!1,exclusiveTax:null,featuredLocations:!1,fullMapStart:!1,fullMapStartBlank:!1,fullMapStartListLimit:!1,infoBubble:null,inlineDirections:!1,lengthUnit:"m",listColor1:"#ffffff",listColor2:"#eeeeee",loading:!1,locationsPerPage:10,mapSettings:{mapTypeId:google.maps.MapTypeId.ROADMAP,zoom:12},markerCluster:null,markerImg:null,markerDim:null,maxDistance:!1,modal:!1,nameAttribute:"name",nameSearch:!1,noForm:!1,openNearest:!1,originMarker:!1,originMarkerDim:null,originMarkerImg:null,pagination:!1,querystringParams:!1,selectedMarkerImg:null,selectedMarkerImgDim:null,sessionStorage:!1,slideMap:!0,sortBy:null,storeLimit:26,taxonomyFilters:null,visibleMarkersList:!1,xmlElement:"marker",addressID:"bh-sl-address",closeIcon:"bh-sl-close-icon",formContainer:"bh-sl-form-container",formID:"bh-sl-user-location",geocodeID:null,lengthSwapID:"bh-sl-length-swap",loadingContainer:"bh-sl-loading",locationList:"bh-sl-loc-list",mapID:"bh-sl-map",maxDistanceID:"bh-sl-maxdistance",modalContent:"bh-sl-modal-content",modalWindow:"bh-sl-modal-window",orderID:"bh-sl-order",overlay:"bh-sl-overlay",regionID:"bh-sl-region",searchID:"bh-sl-search",sortID:"bh-sl-sort",taxonomyFiltersContainer:"bh-sl-filters-container",infowindowTemplatePath:"assets/js/plugins/storeLocator/templates/infowindow-description.html",listTemplatePath:"assets/js/plugins/storeLocator/templates/location-list-description.html",KMLinfowindowTemplatePath:"assets/js/plugins/storeLocator/templates/kml-infowindow-description.html",KMLlistTemplatePath:"assets/js/plugins/storeLocator/templates/kml-location-list-description.html",listTemplateID:null,infowindowTemplateID:null,callbackAutoGeoSuccess:null,callbackBeforeSend:null,callbackCloseDirections:null,callbackCreateMarker:null,callbackDirectionsRequest:null,callbackFilters:null,callbackFormVals:null,callbackGeocodeRestrictions:null,callbackJsonp:null,callbackListClick:null,callbackMapSet:null,callbackMarkerClick:null,callbackModalClose:null,callbackModalOpen:null,callbackModalReady:null,callbackNearestLoc:null,callbackNoResults:null,callbackNotify:null,callbackOrder:null,callbackPageChange:null,callbackRegion:null,callbackSorting:null,callbackSuccess:null,addressErrorAlert:"Unable to find address",autoGeocodeErrorAlert:"Automatic location detection failed. Please fill in your address or zip code.",distanceErrorAlert:"Unfortunately, our closest location is more than ",kilometerLang:"kilometer",kilometersLang:"kilometers",mileLang:"mile",milesLang:"miles",noResultsTitle:"No results",noResultsDesc:"No locations were found with the given criteria. Please modify your selections or input.",nextPage:"Next &raquo;",prevPage:"&laquo; Prev"};a.extend(e.prototype,{init:function(){var b=this;if(this.writeDebug("init"),"km"===this.settings.lengthUnit?F.EarthRadius=6367:F.EarthRadius=3956,j="kml"===this.settings.dataType?"xml":this.settings.dataType,this.settings.inlineDirections===!0&&a("."+this.settings.locationList).prepend('<div class="bh-sl-directions-panel"></div>'),m=this.settings.mapSettings.zoom,Handlebars.registerHelper("niceURL",function(a){return a?a.replace("https://","").replace("http://",""):void 0}),null!==this.settings.taxonomyFilters&&this.taxonomyFiltering(),this.sorting(),this.order(),this.settings.modal===!0&&(null!==this.settings.taxonomyFilters&&a("."+this.settings.taxonomyFiltersContainer).clone(!0,!0).prependTo(g),g.wrap('<div class="'+this.settings.overlay+'"><div class="'+this.settings.modalWindow+'"><div class="'+this.settings.modalContent+'">'),a("."+this.settings.modalWindow).prepend('<div class="'+this.settings.closeIcon+'"></div>'),a("."+this.settings.overlay).hide()),this.settings.autoComplete===!0){var d=c.getElementById(this.settings.addressID),e=new google.maps.places.Autocomplete(d,this.settings.autoCompleteOptions);this.settings.autoComplete===!0&&this.settings.autoCompleteDisableListener!==!0&&e.addListener("place_changed",function(a){b.processForm(a)})}this._loadTemplates()},destroy:function(){this.writeDebug("destroy"),this.reset();var b=a("#"+this.settings.mapID);if(C.length)for(var d=0;d<=C.length;d++)google.maps.event.removeListener(C[d]);a("."+this.settings.locationList+" ul").empty(),b.hasClass("bh-sl-map-open")&&b.empty().removeClass("bh-sl-map-open"),this.settings.modal===!0&&a(". "+this.settings.overlay).remove(),b.attr("style",""),g.hide(),a.removeData(g.get(0)),a(c).off(f),g.unbind()},reset:function(){if(this.writeDebug("reset"),A=[],z=[],B=[],C=[],x=!1,a(c).off("click."+f,"."+this.settings.locationList+" li"),a("."+this.settings.locationList+" .bh-sl-close-directions-container").length&&a(".bh-sl-close-directions-container").remove(),this.settings.inlineDirections===!0){var b=a("."+this.settings.locationList+" .adp");b.length>0&&(b.remove(),a("."+this.settings.locationList+" ul").fadeIn()),a(c).off("click","."+this.settings.locationList+" li .loc-directions a")}this.settings.pagination===!0&&a(c).off("click."+f,".bh-sl-pagination li")},formFiltersReset:function(){if(this.writeDebug("formFiltersReset"),null!==this.settings.taxonomyFilters){var b=a("."+this.settings.taxonomyFiltersContainer+" input"),c=a("."+this.settings.taxonomyFiltersContainer+" select");"object"==typeof b&&(b.each(function(){(a(this).is('input[type="checkbox"]')||a(this).is('input[type="radio"]'))&&a(this).prop("checked",!1)}),c.each(function(){a(this).prop("selectedIndex",0)}))}},mapReload:function(){this.writeDebug("mapReload"),this.reset(),y=!0,null!==this.settings.taxonomyFilters&&(this.formFiltersReset(),this.taxonomyFiltersInit()),q&&r?(this.settings.mapSettings.zoom=m,this.processForm()):this.mapping(G)},notify:function(a){this.writeDebug("notify",a),this.settings.callbackNotify?this.settings.callbackNotify.call(this,a):alert(a)},geoCodeCalcToRadian:function(a){return this.writeDebug("geoCodeCalcToRadian",a),a*(Math.PI/180)},geoCodeCalcDiffRadian:function(a,b){return this.writeDebug("geoCodeCalcDiffRadian",arguments),this.geoCodeCalcToRadian(b)-this.geoCodeCalcToRadian(a)},geoCodeCalcCalcDistance:function(a,b,c,d,e){return this.writeDebug("geoCodeCalcCalcDistance",arguments),2*e*Math.asin(Math.min(1,Math.sqrt(Math.pow(Math.sin(this.geoCodeCalcDiffRadian(a,c)/2),2)+Math.cos(this.geoCodeCalcToRadian(a))*Math.cos(this.geoCodeCalcToRadian(c))*Math.pow(Math.sin(this.geoCodeCalcDiffRadian(b,d)/2),2))))},getQueryString:function(a){if(this.writeDebug("getQueryString",a),a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}},getMap:function(){return this.map},_loadTemplates:function(){this.writeDebug("_loadTemplates");var b,c=this,d='<div class="bh-sl-error">Error: Could not load plugin templates. Check the paths and ensure they have been uploaded. Paths will be wrong if you do not run this from a web server.</div>';"kml"===this.settings.dataType&&null===this.settings.listTemplateID&&null===this.settings.infowindowTemplateID?a.when(a.get(this.settings.KMLinfowindowTemplatePath,function(a){b=a,i=Handlebars.compile(b)}),a.get(this.settings.KMLlistTemplatePath,function(a){b=a,h=Handlebars.compile(b)})).then(function(){c.locator()},function(){throw a("."+c.settings.formContainer).append(d),new Error("Could not load storeLocator plugin templates")}):null!==this.settings.listTemplateID&&null!==this.settings.infowindowTemplateID?(i=Handlebars.compile(a("#"+this.settings.infowindowTemplateID).html()),h=Handlebars.compile(a("#"+this.settings.listTemplateID).html()),c.locator()):a.when(a.get(this.settings.infowindowTemplatePath,function(a){b=a,i=Handlebars.compile(b)}),a.get(this.settings.listTemplatePath,function(a){b=a,h=Handlebars.compile(b)})).then(function(){c.locator()},function(){throw a("."+c.settings.formContainer).append(d),new Error("Could not load storeLocator plugin templates")})},locator:function(){this.writeDebug("locator"),this.settings.slideMap===!0&&g.hide(),this._start(),this._formEventHandler()},_formEventHandler:function(){this.writeDebug("_formEventHandler");var b=this;this.settings.noForm===!0?(a(c).on("click."+f,"."+this.settings.formContainer+" button",function(a){b.processForm(a)}),a(c).on("keydown."+f,function(c){13===c.keyCode&&a("#"+b.settings.addressID).is(":focus")&&b.processForm(c)})):a(c).on("submit."+f,"#"+this.settings.formID,function(a){b.processForm(a)}),a(".bh-sl-reset").length&&a("#"+this.settings.mapID).length&&a(c).on("click."+f,".bh-sl-reset",function(){b.mapReload()})},_getData:function(b,c,d,e,f){this.writeDebug("_getData",arguments);var g=this,h="",i="",k="";if("undefined"!=typeof e&&"undefined"!=typeof e.geometry.bounds&&(k=e.formatted_address,h=JSON.stringify(e.geometry.bounds.getNorthEast()),i=JSON.stringify(e.geometry.bounds.getSouthWest())),this.settings.callbackBeforeSend&&this.settings.callbackBeforeSend.call(this,b,c,d,k,h,i,f),null===g.settings.dataRaw){var l=a.Deferred();this.settings.loading===!0&&a("."+this.settings.formContainer).append('<div class="'+this.settings.loadingContainer+'"></div>');var m={origLat:b,origLng:c,origAddress:d,formattedAddress:k,boundsNorthEast:h,boundsSouthWest:i};return null!==this.settings.ajaxData&&"object"==typeof this.settings.ajaxData&&a.extend(m,this.settings.ajaxData),a.ajax({type:"GET",url:this.settings.dataLocation+("jsonp"===this.settings.dataType?(this.settings.dataLocation.match(/\?/)?"&":"?")+"callback=?":""),data:m,dataType:j,jsonpCallback:"jsonp"===this.settings.dataType?this.settings.callbackJsonp:null}).done(function(b){l.resolve(b),g.settings.loading===!0&&a("."+g.settings.formContainer+" ."+g.settings.loadingContainer).remove()}).fail(l.reject),l.promise()}return"xml"===j?a.parseXML(g.settings.dataRaw):"json"===j?Array.isArray&&Array.isArray(g.settings.dataRaw)?g.settings.dataRaw:"string"==typeof g.settings.dataRaw?JSON.parse(g.settings.dataRaw):[]:void 0},_start:function(){this.writeDebug("_start");var d,e=this,g=this.settings.autoGeocode;if(e.settings.fullMapStartBlank!==!1){var h=a("#"+e.settings.mapID);h.addClass("bh-sl-map-open");var i=e.settings.mapSettings;i.zoom=e.settings.fullMapStartBlank,d=new google.maps.LatLng(this.settings.defaultLat,this.settings.defaultLng),i.center=d,e.map=new google.maps.Map(c.getElementById(e.settings.mapID),i),google.maps.event.addDomListener(b,"resize",function(){var a=e.map.getCenter();google.maps.event.trigger(e.map,"resize"),e.map.setCenter(a)}),e.settings.fullMapStartBlank=!1,i.zoom=m}else this.settings.defaultLoc===!0&&this.defaultLocation(),""!==a.trim(a("#"+this.settings.addressID).val())?(e.writeDebug("Using Address Field"),e.processForm(null),g=!1):this.settings.fullMapStart===!0&&(this.settings.querystringParams===!0&&this.getQueryString(this.settings.addressID)||this.settings.querystringParams===!0&&this.getQueryString(this.settings.searchID)||this.settings.querystringParams===!0&&this.getQueryString(this.settings.maxDistanceID)?(e.writeDebug("Using Query String"),this.processForm(null),g=!1):this.mapping(null));this.settings.autoGeocode===!0&&g===!0&&(e.writeDebug("Auto Geo"),e.htmlGeocode()),null!==this.settings.autoGeocode&&(e.writeDebug("Button Geo"),a(c).on("click."+f,"#"+this.settings.geocodeID,function(){e.htmlGeocode()}))},htmlGeocode:function(){this.writeDebug("htmlGeocode",arguments);var a=this;return a.settings.sessionStorage===!0&&b.sessionStorage&&b.sessionStorage.getItem("myGeo")?(a.writeDebug("Using Session Saved Values for GEO"),a.autoGeocodeQuery(JSON.parse(b.sessionStorage.getItem("myGeo"))),!1):void(navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(c){a.writeDebug("Current Position Result");var d={coords:{latitude:c.coords.latitude,longitude:c.coords.longitude,accuracy:c.coords.accuracy}};a.settings.sessionStorage===!0&&b.sessionStorage&&b.sessionStorage.setItem("myGeo",JSON.stringify(d)),a.settings.callbackAutoGeoSuccess&&a.settings.callbackAutoGeoSuccess.call(this,d),a.autoGeocodeQuery(d)},function(b){a._autoGeocodeError(b)}))},googleGeocode:function(a){a.writeDebug("googleGeocode",arguments);var b=new google.maps.Geocoder;this.geocode=function(a,c){b.geocode(a,function(a,b){if(b!==google.maps.GeocoderStatus.OK)throw c(null),new Error("Geocode was not successful for the following reason: "+b);var d={};d.latitude=a[0].geometry.location.lat(),d.longitude=a[0].geometry.location.lng(),d.geocodeResult=a[0],c(d)})}},reverseGoogleGeocode:function(a){a.writeDebug("reverseGoogleGeocode",arguments);var b=new google.maps.Geocoder;this.geocode=function(a,c){b.geocode(a,function(a,b){if(b!==google.maps.GeocoderStatus.OK)throw c(null),new Error("Reverse geocode was not successful for the following reason: "+b);if(a[0]){var d={};d.address=a[0].formatted_address,c(d)}})}},roundNumber:function(a,b){return this.writeDebug("roundNumber",arguments),Math.round(a*Math.pow(10,b))/Math.pow(10,b)},isEmptyObject:function(a){this.writeDebug("isEmptyObject",arguments);for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},hasEmptyObjectVals:function(a){this.writeDebug("hasEmptyObjectVals",arguments);var b=!0;for(var c in a)a.hasOwnProperty(c)&&""!==a[c]&&0!==a[c].length&&(b=!1);return b},modalClose:function(){this.writeDebug("modalClose"),this.settings.callbackModalClose&&this.settings.callbackModalClose.call(this),D={},a("."+this.settings.overlay+" select").prop("selectedIndex",0),a("."+this.settings.overlay+" input").prop("checked",!1),a("."+this.settings.overlay).hide()},_createLocationVariables:function(a){this.writeDebug("_createLocationVariables",arguments);var b;E={};for(var c in A[a])A[a].hasOwnProperty(c)&&(b=A[a][c],("distance"===c||"altdistance"===c)&&(b=this.roundNumber(b,2)),E[c]=b)},sortAlpha:function(a){this.writeDebug("sortAlpha",arguments);var b=this.settings.sortBy.hasOwnProperty("prop")&&"undefined"!=typeof this.settings.sortBy.prop?this.settings.sortBy.prop:"name";this.settings.sortBy.hasOwnProperty("order")&&"desc"===this.settings.sortBy.order.toString()?a.sort(function(a,c){return c[b].toLowerCase().localeCompare(a[b].toLowerCase())}):a.sort(function(a,c){return a[b].toLowerCase().localeCompare(c[b].toLowerCase())})},sortDate:function(a){this.writeDebug("sortDate",arguments);var b=this.settings.sortBy.hasOwnProperty("prop")&&"undefined"!=typeof this.settings.sortBy.prop?this.settings.sortBy.prop:"date";this.settings.sortBy.hasOwnProperty("order")&&"desc"===this.settings.sortBy.order.toString()?a.sort(function(a,c){return new Date(c[b]).getTime()-new Date(a[b]).getTime()}):a.sort(function(a,c){return new Date(a[b]).getTime()-new Date(c[b]).getTime()})},sortNumerically:function(a){this.writeDebug("sortNumerically",arguments);var b=null!==this.settings.sortBy&&this.settings.sortBy.hasOwnProperty("prop")&&"undefined"!=typeof this.settings.sortBy.prop?this.settings.sortBy.prop:"distance";null!==this.settings.sortBy&&this.settings.sortBy.hasOwnProperty("order")&&"desc"===this.settings.sortBy.order.toString()?a.sort(function(a,c){return c[b]<a[b]?-1:c[b]>a[b]?1:0}):a.sort(function(a,c){return a[b]<c[b]?-1:a[b]>c[b]?1:0})},sortCustom:function(a){this.writeDebug("sortCustom",arguments),this.settings.sortBy.hasOwnProperty("method")&&"alpha"===this.settings.sortBy.method.toString()?this.sortAlpha(a):this.settings.sortBy.hasOwnProperty("method")&&"date"===this.settings.sortBy.method.toString()?this.sortDate(a):this.sortNumerically(a)},filterData:function(a,b){this.writeDebug("filterData",arguments);var c=!0;for(var d in b)if(b.hasOwnProperty(d))if(this.settings.exclusiveFiltering===!0||null!==this.settings.exclusiveTax&&Array.isArray(this.settings.exclusiveTax)&&-1!==this.settings.exclusiveTax.indexOf(d)){var e=b[d],f=[];if("undefined"!=typeof a[d])for(var g=0;g<e.length;g++)f[g]=new RegExp(e[g],"i").test(a[d].replace(/([^\x00-\x7F]|[.*+?^=!:${}()|\[\]\/\\]|&\s+)/g,""));-1===f.indexOf(!0)&&(c=!1)}else"undefined"!=typeof a[d]&&new RegExp(b[d].join(""),"i").test(a[d].replace(/([^\x00-\x7F]|[.*+?^=!:${}()|\[\]\/\\]|&\s+)/g,""))||(c=!1);return c?!0:void 0},_paginationOutput:function(a,b){this.writeDebug("_paginationOutput",arguments),a=parseFloat(a);var c="",d=a+1,e=a-1;a>0&&(c+='<li class="bh-sl-next-prev" data-page="'+e+'">'+this.settings.prevPage+"</li>");for(var f=0;f<Math.ceil(b);f++){var g=f+1;c+=f===a?'<li class="bh-sl-current" data-page="'+f+'">'+g+"</li>":'<li data-page="'+f+'">'+g+"</li>"}return b>d&&(c+='<li class="bh-sl-next-prev" data-page="'+d+'">'+this.settings.nextPage+"</li>"),c},paginationSetup:function(b){this.writeDebug("paginationSetup",arguments);var c,d="",e=a(".bh-sl-pagination-container .bh-sl-pagination");c=-1===this.settings.storeLimit||A.length<this.settings.storeLimit?A.length/this.settings.locationsPerPage:this.settings.storeLimit/this.settings.locationsPerPage,"undefined"==typeof b&&(b=0),0===e.length?d=this._paginationOutput(b,c):(e.empty(),d=this._paginationOutput(b,c)),e.append(d)},markerImage:function(a,b,c){this.writeDebug("markerImage",arguments);var d;return d="undefined"!=typeof b&&"undefined"!=typeof c?{url:a,size:new google.maps.Size(b,c),scaledSize:new google.maps.Size(b,c)}:{url:a,size:new google.maps.Size(32,32),scaledSize:new google.maps.Size(32,32)}},createMarker:function(a,b,c,d,e,f){this.writeDebug("createMarker",arguments);var g,h,i,j=[];if(null!==this.settings.catMarkers&&"undefined"!=typeof f)if(-1!==f.indexOf(",")){j=f.split(",");for(var k=0;k<j.length;k++)j[k]in this.settings.catMarkers&&(h=this.markerImage(this.settings.catMarkers[j[k]][0],parseInt(this.settings.catMarkers[j[k]][1]),parseInt(this.settings.catMarkers[j[k]][2])))}else f in this.settings.catMarkers&&(h=this.markerImage(this.settings.catMarkers[f][0],parseInt(this.settings.catMarkers[f][1]),parseInt(this.settings.catMarkers[f][2])));return null!==this.settings.markerImg&&(h=null===this.settings.markerDim?this.markerImage(this.settings.markerImg):this.markerImage(this.settings.markerImg,this.settings.markerDim.width,this.settings.markerDim.height)),this.settings.callbackCreateMarker?g=this.settings.callbackCreateMarker.call(this,e,a,d,f):this.settings.disableAlphaMarkers===!0||-1===this.settings.storeLimit||this.settings.storeLimit>26||null!==this.settings.catMarkers||null!==this.settings.markerImg||this.settings.fullMapStart===!0&&x===!0&&(isNaN(this.settings.fullMapStartListLimit)||this.settings.fullMapStartListLimit>26||-1===this.settings.fullMapStartListLimit)?g=new google.maps.Marker({position:a,map:e,draggable:!1,icon:h}):(i={url:"https://mt.googleapis.com/vt/icon/name=icons/spotlight/spotlight-waypoint-b.png&text="+d+"&psize=16&font=fonts/Roboto-Regular.ttf&color=ff333333&ax=44&ay=48"},g=new google.maps.Marker({position:a,map:e,icon:i,draggable:!1})),g},_defineLocationData:function(b,c,d){this.writeDebug("_defineLocationData",arguments);var e="";this._createLocationVariables(b.get("id"));var f,g;E.distance<=1?"km"===this.settings.lengthUnit?(g=this.settings.kilometerLang,f=this.settings.mileLang):(g=this.settings.mileLang,f=this.settings.kilometerLang):"km"===this.settings.lengthUnit?(g=this.settings.kilometersLang,f=this.settings.milesLang):(g=this.settings.milesLang,f=this.settings.kilometersLang);var h=b.get("id");return e=this.settings.disableAlphaMarkers===!0||-1===this.settings.storeLimit||this.settings.storeLimit>26||this.settings.fullMapStart===!0&&x===!0&&(isNaN(this.settings.fullMapStartListLimit)||this.settings.fullMapStartListLimit>26||-1===this.settings.fullMapStartListLimit)?h+1:d>0?String.fromCharCode("A".charCodeAt(0)+(c+h)):String.fromCharCode("A".charCodeAt(0)+h),{location:[a.extend(E,{markerid:h,marker:e,altlength:f,length:g,origin:k})]}},listSetup:function(b,c,d){this.writeDebug("listSetup",arguments);var e=this._defineLocationData(b,c,d),f=h(e);a("."+this.settings.locationList+" > ul").append(f)},changeSelectedMarker:function(a){var b;"undefined"!=typeof w&&w.setIcon(v),b=null===this.settings.selectedMarkerImgDim?this.markerImage(this.settings.selectedMarkerImg):this.markerImage(this.settings.selectedMarkerImg,this.settings.selectedMarkerImgDim.width,this.settings.selectedMarkerImgDim.height),v=a.icon,a.setIcon(b),w=a},createInfowindow:function(b,c,d,e,f){this.writeDebug("createInfowindow",arguments);var g=this,h=this._defineLocationData(b,e,f),j=i(h);"left"===c?(d.setContent(j),d.open(b.get("map"),b)):google.maps.event.addListener(b,"click",function(){d.setContent(j),d.open(b.get("map"),b);var c=b.get("id"),e=a("."+g.settings.locationList+" li[data-markerid="+c+"]");if(e.length>0){g.settings.callbackMarkerClick&&g.settings.callbackMarkerClick.call(this,b,c,e,A[c]),a("."+g.settings.locationList+" li").removeClass("list-focus"),e.addClass("list-focus");var f=a("."+g.settings.locationList);f.animate({scrollTop:e.offset().top-f.offset().top+f.scrollTop()})}null!==g.settings.selectedMarkerImg&&g.changeSelectedMarker(b)})},autoGeocodeQuery:function(b){this.writeDebug("autoGeocodeQuery",arguments);var c,d=this,e=null,f=a("#"+this.settings.maxDistanceID);this.settings.querystringParams===!0&&this.getQueryString(this.settings.maxDistanceID)?(e=this.getQueryString(this.settings.maxDistanceID),""!==f.val()&&(e=f.val())):this.settings.maxDistance===!0&&(e=f.val()||"");var g=new this.reverseGoogleGeocode(this),h=new google.maps.LatLng(b.coords.latitude,b.coords.longitude);g.geocode({latLng:h},function(f){null!==f?(c=p=f.address,q=G.lat=b.coords.latitude,r=G.lng=b.coords.longitude,G.origin=c,G.distance=e,d.mapping(G),"undefined"!=typeof c&&a("#"+d.settings.addressID).val(c)):d.notify(d.settings.addressErrorAlert)})},_autoGeocodeError:function(){this.writeDebug("_autoGeocodeError"),this.notify(this.settings.autoGeocodeErrorAlert)},defaultLocation:function(){this.writeDebug("defaultLocation");var b,c=this,d=null,e=a("#"+this.settings.maxDistanceID);this.settings.querystringParams===!0&&this.getQueryString(this.settings.maxDistanceID)?(d=this.getQueryString(this.settings.maxDistanceID),""!==e.val()&&(d=e.val())):this.settings.maxDistance===!0&&(d=e.val()||"");var f=new this.reverseGoogleGeocode(this),g=new google.maps.LatLng(this.settings.defaultLat,this.settings.defaultLng);f.geocode({latLng:g},function(a){null!==a?(b=p=a.address,q=G.lat=c.settings.defaultLat,r=G.lng=c.settings.defaultLng,G.distance=d,G.origin=b,c.mapping(G)):c.notify(c.settings.addressErrorAlert)})},paginationChange:function(a){this.writeDebug("paginationChange",arguments),this.settings.callbackPageChange&&this.settings.callbackPageChange.call(this,a),G.page=a,this.mapping(G)},getAddressByMarker:function(a){this.writeDebug("getAddressByMarker",arguments);var b="";return A[a].address&&(b+=A[a].address+" "),A[a].address2&&(b+=A[a].address2+" "),A[a].city&&(b+=A[a].city+", "),A[a].state&&(b+=A[a].state+" "),A[a].postal&&(b+=A[a].postal+" "),A[a].country&&(b+=A[a].country+" "),b},clearMarkers:function(){this.writeDebug("clearMarkers");var a=null;a=A.length<this.settings.storeLimit?A.length:this.settings.storeLimit;for(var b=0;a>b;b++)C[b].setMap(null)},directionsRequest:function(b,d,e){this.writeDebug("directionsRequest",arguments),this.settings.callbackDirectionsRequest&&this.settings.callbackDirectionsRequest.call(this,b,d,e,A[d]);var f=this.getAddressByMarker(d);if(f){a("."+this.settings.locationList+" ul").hide(),this.clearMarkers(),null!==t&&"undefined"!=typeof t&&(t.setMap(null),t=null),t=new google.maps.DirectionsRenderer,u=new google.maps.DirectionsService,t.setMap(e),t.setPanel(a(".bh-sl-directions-panel").get(0));var g={origin:b,destination:f,travelMode:google.maps.TravelMode.DRIVING};u.route(g,function(a,b){b===google.maps.DirectionsStatus.OK&&t.setDirections(a)}),a("."+this.settings.locationList).prepend('<div class="bh-sl-close-directions-container"><div class="'+this.settings.closeIcon+'"></div></div>')}a(c).off("click","."+this.settings.locationList+" li .loc-directions a")},closeDirections:function(){this.writeDebug("closeDirections"),this.settings.callbackCloseDirections&&this.settings.callbackCloseDirections.call(this),this.reset(),q&&r&&(0===this.countFilters()?this.settings.mapSettings.zoom=m:this.settings.mapSettings.zoom=0,this.processForm(null)),a(c).off("click."+f,"."+this.settings.locationList+" .bh-sl-close-icon")},lengthUnitSwap:function(b){this.writeDebug("lengthUnitSwap",arguments),"alt-distance"===b.val()?(a("."+this.settings.locationList+" .loc-alt-dist").show(),a("."+this.settings.locationList+" .loc-default-dist").hide()):"default-distance"===b.val()&&(a("."+this.settings.locationList+" .loc-default-dist").show(),a("."+this.settings.locationList+" .loc-alt-dist").hide())},processForm:function(b){this.writeDebug("processForm",arguments);var c=this,d=null,e={},f=a("#"+this.settings.addressID),g=a("#"+this.settings.searchID),h=a("#"+this.settings.maxDistanceID),i="";if("undefined"!=typeof b&&null!==b&&b.preventDefault(),a("."+c.settings.formContainer+" input, ."+c.settings.formContainer+" select").blur(),this.settings.querystringParams===!0&&(this.getQueryString(this.settings.addressID)||this.getQueryString(this.settings.searchID)||this.getQueryString(this.settings.maxDistanceID))?(p=this.getQueryString(this.settings.addressID),o=this.getQueryString(this.settings.searchID),d=this.getQueryString(this.settings.maxDistanceID),""!==f.val()&&(p=f.val()),""!==g.val()&&(o=g.val()),""!==h.val()&&(d=h.val())):(p=f.val()||"",o=g.val()||"",this.settings.maxDistance===!0&&(d=h.val()||"")),i=this.settings.callbackRegion?this.settings.callbackRegion.call(this,p,o,d):a("#"+this.settings.regionID).val(),this.settings.callbackFormVals&&this.settings.callbackFormVals.call(this,p,o,d,i),"undefined"!=typeof i&&(e={country:i}),"function"==typeof this.settings.callbackGeocodeRestrictions&&(e=this.settings.callbackGeocodeRestrictions.call(this,p,o,d)),""===p&&""===o&&this.settings.autoGeocode!==!0)this._start();else if(""!==p)if("undefined"!=typeof k&&"undefined"!=typeof q&&"undefined"!=typeof r&&p===k)G.lat=q,G.lng=r,G.origin=p,G.name=o,G.distance=d,c.mapping(G);else{var j=new this.googleGeocode(this);j.geocode({address:p,componentRestrictions:e,region:i},function(a){null!==a?(q=a.latitude,r=a.longitude,G.lat=q,G.lng=r,G.origin=p,G.name=o,G.distance=d,G.geocodeResult=a.geocodeResult,c.mapping(G)):c.notify(c.settings.addressErrorAlert)})}else""!==o?(""===p&&delete G.origin,G.name=o,c.mapping(G)):this.settings.autoGeocode===!0&&(G.lat=q,G.lng=r,G.origin=p,G.name=o,G.distance=d,c.mapping(G))},locationsSetup:function(a,b,c,d,e){if(this.writeDebug("locationsSetup",arguments),"undefined"!=typeof d&&(a.distance||(a.distance=this.geoCodeCalcCalcDistance(b,c,a.lat,a.lng,F.EarthRadius),"m"===this.settings.lengthUnit?a.altdistance=1.609344*parseFloat(a.distance):"km"===this.settings.lengthUnit&&(a.altdistance=parseFloat(a.distance)/1.609344))),this.settings.maxDistance===!0&&"undefined"!=typeof e&&null!==e){if(!(a.distance<=e))return;A.push(a)}else if(this.settings.maxDistance===!0&&this.settings.querystringParams===!0&&"undefined"!=typeof e&&null!==e){if(!(a.distance<=e))return;A.push(a)}else A.push(a)},sorting:function(){this.writeDebug("sorting",arguments);var b=this,c=a("#"+b.settings.mapID),d=a("#"+b.settings.sortID);0!==d.length&&d.on("change."+f,function(d){d.stopPropagation(),b.settings.pagination===!0&&b.paginationChange(0);var e,f;e="undefined"!=typeof a(this).find(":selected").attr("data-method")?a(this).find(":selected").attr("data-method"):"distance",f=a(this).val(),b.settings.sortBy.method=e,b.settings.sortBy.prop=f,b.settings.callbackSorting&&b.settings.callbackSorting.call(this,b.settings.sortBy),c.hasClass("bh-sl-map-open")&&b.mapping(G)})},order:function(){this.writeDebug("order",arguments);var b=this,c=a("#"+b.settings.mapID),d=a("#"+b.settings.orderID);0!==d.length&&d.on("change."+f,function(d){d.stopPropagation(),b.settings.pagination===!0&&b.paginationChange(0),b.settings.sortBy.order=a(this).val(),b.settings.callbackOrder&&b.settings.callbackOrder.call(this,b.settings.order),c.hasClass("bh-sl-map-open")&&b.mapping(G)})},countFilters:function(){this.writeDebug("countFilters");var a=0;if(!this.isEmptyObject(D))for(var b in D)D.hasOwnProperty(b)&&(a+=D[b].length);return a},_existingCheckedFilters:function(b){this.writeDebug("_existingCheckedFilters",arguments),a("#"+this.settings.taxonomyFilters[b]+" input[type=checkbox]").each(function(){if(a(this).prop("checked")){var c=a(this).val();"undefined"!=typeof c&&""!==c&&-1===D[b].indexOf(c)&&D[b].push(c)}})},_existingSelectedFilters:function(b){this.writeDebug("_existingSelectedFilters",arguments),a("#"+this.settings.taxonomyFilters[b]+" select").each(function(){var c=a(this).val();"undefined"!=typeof c&&""!==c&&-1===D[b].indexOf(c)&&(D[b]=[c])})},_existingRadioFilters:function(b){this.writeDebug("_existingRadioFilters",arguments),a("#"+this.settings.taxonomyFilters[b]+" input[type=radio]").each(function(){if(a(this).prop("checked")){var c=a(this).val();"undefined"!=typeof c&&""!==c&&-1===D[b].indexOf(c)&&(D[b]=[c])}})},checkFilters:function(){this.writeDebug("checkFilters");for(var a in this.settings.taxonomyFilters)this.settings.taxonomyFilters.hasOwnProperty(a)&&(this._existingCheckedFilters(a),this._existingSelectedFilters(a),this._existingRadioFilters(a))},selectQueryStringFilters:function(b,c){this.writeDebug("selectQueryStringFilters",arguments);var d=a("#"+this.settings.taxonomyFilters[b]);if(d.find('input[type="checkbox"]').length)for(var e=0;e<c.length;e++)d.find('input:checkbox[value="'+c[e]+'"]').prop("checked",!0);d.find("select").length&&d.find('option[value="'+c[0]+'"]').prop("selected",!0),d.find('input[type="radio"]').length&&d.find('input:radio[value="'+c[0]+'"]').prop("checked",!0)},checkQueryStringFilters:function(){this.writeDebug("checkQueryStringFilters",arguments);for(var a in D)if(D.hasOwnProperty(a)){var b=this.getQueryString(a);-1!==b.indexOf(",")&&(b=b.split(",")),"undefined"!=typeof b&&""!==b&&-1===D[a].indexOf(b)&&(Array.isArray(b)?D[a]=b:D[a]=[b]),D[a].length&&this.selectQueryStringFilters(a,D[a])}},getFilterKey:function(a){this.writeDebug("getFilterKey",arguments);for(var b in this.settings.taxonomyFilters)if(this.settings.taxonomyFilters.hasOwnProperty(b))for(var c=0;c<this.settings.taxonomyFilters[b].length;c++)if(this.settings.taxonomyFilters[b]===a)return b},taxonomyFiltersInit:function(){this.writeDebug("taxonomyFiltersInit");for(var a in this.settings.taxonomyFilters)this.settings.taxonomyFilters.hasOwnProperty(a)&&(D[a]=[])},taxonomyFiltering:function(){this.writeDebug("taxonomyFiltering");var b=this;b.taxonomyFiltersInit(),b.checkQueryStringFilters(),a("."+this.settings.taxonomyFiltersContainer).on("change."+f,"input, select",function(c){c.stopPropagation();var d,e,f;if(b.settings.pagination===!0&&b.paginationChange(0),a(this).is('input[type="checkbox"]')){if(b.checkFilters(),d=a(this).val(),e=a(this).closest(".bh-sl-filters").attr("id"),f=b.getFilterKey(e))if(a(this).prop("checked"))-1===D[f].indexOf(d)&&D[f].push(d),a("#"+b.settings.mapID).hasClass("bh-sl-map-open")===!0&&(q&&r?(b.settings.mapSettings.zoom=0,b.processForm()):b.mapping(G));else{var g=D[f].indexOf(d);g>-1&&(D[f].splice(g,1),a("#"+b.settings.mapID).hasClass("bh-sl-map-open")===!0&&(q&&r?(0===b.countFilters()?b.settings.mapSettings.zoom=m:b.settings.mapSettings.zoom=0,b.processForm()):b.mapping(G)))}}else(a(this).is("select")||a(this).is('input[type="radio"]'))&&(b.checkFilters(),d=a(this).val(),e=a(this).closest(".bh-sl-filters").attr("id"),f=b.getFilterKey(e),d?f&&(D[f]=[d],a("#"+b.settings.mapID).hasClass("bh-sl-map-open")===!0&&(q&&r?(b.settings.mapSettings.zoom=0,
b.processForm()):b.mapping(G))):(f&&(D[f]=[]),b.reset(),q&&r?(b.settings.mapSettings.zoom=m,b.processForm()):b.mapping(G)))})},checkVisibleMarkers:function(b,c){this.writeDebug("checkVisibleMarkers",arguments);var d,e,f=this;a("."+this.settings.locationList+" ul").empty(),a(b).each(function(b,g){c.getBounds().contains(g.getPosition())&&(f.listSetup(g,0,0),e=h(d),a("."+f.settings.locationList+" > ul").append(e))}),a("."+this.settings.locationList+" ul li:even").css("background",this.settings.listColor1),a("."+this.settings.locationList+" ul li:odd").css("background",this.settings.listColor2)},dragSearch:function(a){this.writeDebug("dragSearch",arguments);var b,c=a.getCenter(),d=this;this.settings.mapSettings.zoom=a.getZoom(),q=G.lat=c.lat(),r=G.lng=c.lng();var e=new this.reverseGoogleGeocode(this);b=new google.maps.LatLng(G.lat,G.lng),e.geocode({latLng:b},function(a){null!==a?(G.origin=p=a.address,d.mapping(G)):d.notify(d.settings.addressErrorAlert)})},emptyResult:function(){this.writeDebug("emptyResult",arguments);var b,d,e=a("."+this.settings.locationList+" ul"),f=this.settings.mapSettings;this.map=new google.maps.Map(c.getElementById(this.settings.mapID),f),this.settings.callbackNoResults&&this.settings.callbackNoResults.call(this,this.map,f),e.empty(),d=a('<li><div class="bh-sl-noresults-title">'+this.settings.noResultsTitle+'</div><br><div class="bh-sl-noresults-desc">'+this.settings.noResultsDesc+"</li>").hide().fadeIn(),e.append(d),b=q&&r?new google.maps.LatLng(q,r):new google.maps.LatLng(0,0),this.map.setCenter(b),m&&this.map.setZoom(m)},originMarker:function(a,b,c){if(this.writeDebug("originMarker",arguments),this.settings.originMarker===!0){var d,e="";"undefined"!=typeof b&&(e=null!==this.settings.originMarkerImg?null===this.settings.originMarkerDim?this.markerImage(this.settings.originMarkerImg):this.markerImage(this.settings.originMarkerImg,this.settings.originMarkerDim.width,this.settings.originMarkerDim.height):{url:"https://mt.googleapis.com/vt/icon/name=icons/spotlight/spotlight-waypoint-a.png"},d=new google.maps.Marker({position:c,map:a,icon:e,draggable:!1}))}},modalWindow:function(){if(this.writeDebug("modalWindow"),this.settings.modal===!0){var b=this;b.settings.callbackModalOpen&&b.settings.callbackModalOpen.call(this),a("."+b.settings.overlay).fadeIn(),a(c).on("click."+f,"."+b.settings.closeIcon+", ."+b.settings.overlay,function(){b.modalClose()}),a(c).on("click."+f,"."+b.settings.modalWindow,function(a){a.stopPropagation()}),a(c).on("keyup."+f,function(a){27===a.keyCode&&b.modalClose()})}},openNearestLocation:function(b,c,d,e){if(this.writeDebug("openNearestLocation",arguments),!(this.settings.openNearest!==!0||"undefined"==typeof b||this.settings.fullMapStart===!0&&x===!0||this.settings.defaultLoc===!0&&x===!0)){var f=this;f.settings.callbackNearestLoc&&f.settings.callbackNearestLoc.call(this,f.map,b,c,d,e);var g=0,h=C[g];f.createInfowindow(h,"left",c,d,e);var i=a("."+f.settings.locationList),j=a("."+f.settings.locationList+" li[data-markerid="+g+"]");a("."+f.settings.locationList+" li").removeClass("list-focus"),j.addClass("list-focus"),i.animate({scrollTop:j.offset().top-i.offset().top+i.scrollTop()})}},listClick:function(b,d,e,g){this.writeDebug("listClick",arguments);var h=this;a(c).on("click."+f,"."+h.settings.locationList+" li",function(){var c=a(this).data("markerid"),f=C[c];h.settings.callbackListClick&&h.settings.callbackListClick.call(this,c,f,A[c],b),b.panTo(f.getPosition());var i="left";h.settings.bounceMarker===!0?(f.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){f.setAnimation(null),h.createInfowindow(f,i,d,e,g)},700)):h.createInfowindow(f,i,d,e,g),null!==h.settings.selectedMarkerImg&&h.changeSelectedMarker(f),a("."+h.settings.locationList+" li").removeClass("list-focus"),a("."+h.settings.locationList+" li[data-markerid="+c+"]").addClass("list-focus")}),a(c).on("click."+f,"."+h.settings.locationList+" li a",function(a){a.stopPropagation()})},resultsTotalCount:function(b){this.writeDebug("resultsTotalCount",arguments);var c=a(".bh-sl-total-results");"undefined"==typeof b||0>=b||0===c.length||c.text(b)},inlineDirections:function(b,d){if(this.writeDebug("inlineDirections",arguments),this.settings.inlineDirections===!0&&"undefined"!=typeof d){var e=this;a(c).on("click."+f,"."+e.settings.locationList+" li .loc-directions a",function(g){g.preventDefault();var h=a(this).closest("li").attr("data-markerid");e.directionsRequest(d,parseInt(h),b),a(c).on("click."+f,"."+e.settings.locationList+" .bh-sl-close-icon",function(){e.closeDirections()})})}},visibleMarkersList:function(a,b){if(this.writeDebug("visibleMarkersList",arguments),this.settings.visibleMarkersList===!0){var c=this;google.maps.event.addListenerOnce(a,"idle",function(){c.checkVisibleMarkers(b,a)}),google.maps.event.addListener(a,"center_changed",function(){c.checkVisibleMarkers(b,a)}),google.maps.event.addListener(a,"zoom_changed",function(){c.checkVisibleMarkers(b,a)})}},mapping:function(a){this.writeDebug("mapping",arguments);var b,c,d,e,f,g,h=this;this.isEmptyObject(a)||(b=a.lat,c=a.lng,d=a.geocodeResult,e=a.origin,g=a.page),h.settings.pagination===!0&&("undefined"==typeof g||k!==p)&&(g=0),"undefined"==typeof e&&this.settings.nameSearch===!0?n=h._getData():(f=new google.maps.LatLng(b,c),"undefined"!=typeof k&&e===k&&"undefined"!=typeof l?(e=k,n=l):n=h._getData(q,r,e,d,a)),null!==h.settings.taxonomyFilters&&h.hasEmptyObjectVals(D)&&h.checkFilters(),null!==h.settings.dataRaw?h.processData(a,f,n,g):n.done(function(b){h.processData(a,f,b,g)})},processData:function(d,e,h,i){this.writeDebug("processData",arguments);var j,p,q,r,t,u,v,w,E,F,G,H,I,J,K=this,L=0,M={},N=a("#"+K.settings.lengthSwapID);this.isEmptyObject(d)||(j=d.lat,p=d.lng,q=d.origin,r=d.name,t=d.distance);var O=a("#"+K.settings.mapID),P="km"===K.settings.lengthUnit?K.settings.kilometersLang:K.settings.milesLang;if(l=n,"undefined"!=typeof q&&(k=q),K.settings.callbackSuccess&&K.settings.callbackSuccess.call(this,d,e,h,i),H=O.hasClass("bh-sl-map-open"),K.settings.fullMapStart===!0&&H===!1||K.settings.autoGeocode===!0&&H===!1||K.settings.defaultLoc===!0&&H===!1||y===!0?x=!0:K.reset(),O.addClass("bh-sl-map-open"),"json"===K.settings.dataType||"jsonp"===K.settings.dataType)for(var Q=0;L<h.length;Q++){var R=h[Q],S={};for(var T in R)R.hasOwnProperty(T)&&(S[T]=R[T]);K.locationsSetup(S,j,p,q,t),L++}else"kml"===K.settings.dataType?a(h).find("Placemark").each(function(){var b={name:a(this).find("name").text(),lat:a(this).find("coordinates").text().split(",")[1],lng:a(this).find("coordinates").text().split(",")[0],description:a(this).find("description").text()};K.locationsSetup(b,j,p,q,t),L++}):a(h).find(K.settings.xmlElement).each(function(){var a={};for(var b in this.attributes)this.attributes.hasOwnProperty(b)&&(a[this.attributes[b].name]=this.attributes[b].value);K.locationsSetup(a,j,p,q,t),L++});if(K.settings.nameSearch===!0&&"undefined"!=typeof o&&(D[K.settings.nameAttribute]=[o]),null!==K.settings.taxonomyFilters||K.settings.nameSearch===!0){for(var U in D)if(D.hasOwnProperty(U)&&D[U].length>0)for(var V=0;V<D[U].length;V++)M[U]||(M[U]=[]),M[U][V]="(?=.*\\b"+D[U][V].replace(/([^\x00-\x7F]|[.*+?^=!:${}()|\[\]\/\\]|&\s+)/g,"")+"\\b)";K.isEmptyObject(M)||(A=a.grep(A,function(a){return K.filterData(a,M)}))}if(null!==K.settings.sortBy&&"object"==typeof K.settings.sortBy)K.sortCustom(A);else{if("undefined"!=typeof q&&K.sortNumerically(A),K.isEmptyObject(M))if(K.settings.maxDistance===!0&&t)("undefined"==typeof A[0]||A[0].distance>t)&&K.notify(K.settings.distanceErrorAlert+t+" "+P);else{if("undefined"==typeof A[0])throw new Error("No locations found. Please check the dataLocation setting and path.");-1!==K.settings.distanceAlert&&A[0].distance>K.settings.distanceAlert&&(K.notify(K.settings.distanceErrorAlert+K.settings.distanceAlert+" "+P),G=!0)}"undefined"!=typeof A[0]&&(J=A[0])}if(K.settings.featuredLocations===!0&&(z=a.grep(A,function(a){return"true"===a.featured}),B=a.grep(A,function(a){return"true"!==a.featured}),A=[],A=z.concat(B)),K.settings.slideMap===!0&&g.slideDown(),K.settings.pagination===!0&&K.paginationSetup(i),K.settings.altDistanceNoResult===!0&&J.distance>K.settings.distanceAlert)return void K.emptyResult();if(K.isEmptyObject(A)||"none"===A[0].result)return void K.emptyResult();if(K.modalWindow(),s=-1===K.settings.storeLimit||A.length<K.settings.storeLimit||this.settings.fullMapStart===!0&&x===!0&&(!isNaN(this.settings.fullMapStartListLimit)||this.settings.fullMapStartListLimit>26||-1===this.settings.fullMapStartListLimit)?A.length:K.settings.storeLimit,K.settings.pagination===!0?(E=K.settings.locationsPerPage,w=i*K.settings.locationsPerPage,w+E>A.length&&(E=K.settings.locationsPerPage-(w+E-A.length)),A=A.slice(w,w+E),s=A.length):(E=s,w=0),K.resultsTotalCount(A.length),K.settings.fullMapStart===!0&&x===!0&&K.settings.querystringParams!==!0||0===K.settings.mapSettings.zoom||"undefined"==typeof q||G===!0)F=K.settings.mapSettings,v=new google.maps.LatLngBounds;else if(K.settings.pagination===!0){var W=new google.maps.LatLng(A[0].lat,A[0].lng);0===i?(K.settings.mapSettings.center=e,F=K.settings.mapSettings):(K.settings.mapSettings.center=W,F=K.settings.mapSettings)}else K.settings.mapSettings.center=e,F=K.settings.mapSettings;if(K.map=new google.maps.Map(c.getElementById(K.settings.mapID),F),google.maps.event.addDomListener(b,"resize",function(){var a=K.map.getCenter();google.maps.event.trigger(K.map,"resize"),K.map.setCenter(a)}),K.settings.dragSearch===!0&&K.map.addListener("dragend",function(){K.dragSearch(K.map)}),g.data(K.settings.mapID.replace("#",""),K.map),K.settings.callbackMapSet&&K.settings.callbackMapSet.call(this,K.map,e,m,F),"undefined"!=typeof InfoBubble&&null!==K.settings.infoBubble){var X=K.settings.infoBubble;X.map=K.map,I=new InfoBubble(X)}else I=new google.maps.InfoWindow;K.originMarker(K.map,q,e),a(c).on("click."+f,".bh-sl-pagination li",function(b){b.preventDefault(),K.paginationChange(a(this).attr("data-page"))}),K.inlineDirections(K.map,q);for(var Y=0;E-1>=Y;Y++){var Z="";Z=i>0?String.fromCharCode("A".charCodeAt(0)+(w+Y)):String.fromCharCode("A".charCodeAt(0)+Y);var $=new google.maps.LatLng(A[Y].lat,A[Y].lng);u=K.createMarker($,A[Y].name,A[Y].address,Z,K.map,A[Y].category),u.set("id",Y),C[Y]=u,(K.settings.fullMapStart===!0&&x===!0&&K.settings.querystringParams!==!0||0===K.settings.mapSettings.zoom||"undefined"==typeof q||G===!0)&&v.extend($),K.createInfowindow(u,null,I,w,i)}(K.settings.fullMapStart===!0&&x===!0&&K.settings.querystringParams!==!0||0===K.settings.mapSettings.zoom||"undefined"==typeof q||G===!0)&&K.map.fitBounds(v);var _=a("."+K.settings.locationList+" ul");if(_.empty(),x&&K.settings.fullMapStartListLimit!==!1&&!isNaN(K.settings.fullMapStartListLimit)&&-1!==K.settings.fullMapStartListLimit)for(var aa=0;aa<K.settings.fullMapStartListLimit;aa++){var ba=C[aa];K.listSetup(ba,w,i)}else a(C).each(function(a){var b=C[a];K.listSetup(b,w,i)});if(N.length&&(K.lengthUnitSwap(N),N.on("change."+f,function(a){a.stopPropagation(),K.lengthUnitSwap(N)})),K.openNearestLocation(J,I,w,i),"undefined"!=typeof MarkerClusterer&&null!==K.settings.markerCluster){new MarkerClusterer(K.map,C,K.settings.markerCluster)}K.listClick(K.map,I,w,i),a("."+K.settings.locationList+" ul > li:even").css("background",K.settings.listColor1),a("."+K.settings.locationList+" ul > li:odd").css("background",K.settings.listColor2),K.visibleMarkersList(K.map,C),K.settings.modal===!0&&K.settings.callbackModalReady&&K.settings.callbackModalReady.call(this,d),K.settings.callbackFilters&&K.settings.callbackFilters.call(this,D,d)},writeDebug:function(){b.console&&this.settings.debug&&(Function.prototype.bind?this.writeDebug=Function.prototype.bind.call(console.log,console,"StoreLocator :"):this.writeDebug=function(){arguments[0]="StoreLocator : "+arguments[0],Function.prototype.apply.call(console.log,console,arguments)},this.writeDebug.apply(this,arguments))}}),a.fn[f]=function(b){var c=arguments;if(b===d||"object"==typeof b)return this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b))});if("string"==typeof b&&"_"!==b[0]&&"init"!==b){var g;return this.each(function(){var d=a.data(this,"plugin_"+f);d instanceof e&&"function"==typeof d[b]&&(g=d[b].apply(d,Array.prototype.slice.call(c,1))),"destroy"===b&&a.data(this,"plugin_"+f,null)}),g!==d?g:this}}}}(jQuery,window,document);